<template>
    <lightning-card title="Tax Letter Mail Merge">
        <div class="slds-var-p-around_medium">
            <lightning-input type="text"
                             label="Report Id"
                             value={reportId}
                             onchange={handleReportChange}
                             placeholder="00O..." ></lightning-input>
            <lightning-input type="text"
                             label="Template Content Document Id"
                             value={templateId}
                             onchange={handleTemplateChange}
                             placeholder="069..." ></lightning-input>
            <lightning-combobox label="Delivery Option"
                                options={deliveryOptions}
                                value={deliveryOption}
                                onchange={handleDeliveryChange}></lightning-combobox>
            <div class="slds-m-top_medium">
                <lightning-button variant="brand"
                                   label="Preview"
                                   onclick={handlePreview}></lightning-button>
                <lightning-button variant="brand"
                                   label="Generate Letters"
                                   class="slds-m-left_small"
                                   onclick={handleGenerate}
                                   disabled={isGenerateDisabled}></lightning-button>
            </div>
            <template if:true={preview}>
                <section class="slds-box slds-m-top_large">
                    <h3 class="slds-text-heading_small">Preview</h3>
                    <p class="slds-text-body_small slds-m-bottom_small">Records in report: {preview.recordCount}</p>
                    <article class="slds-box slds-theme_default preview-body" lwc:dom="manual"></article>
                    <template if:true={preview.tokens}>
                        <h4 class="slds-text-heading_small slds-m-top_medium">Tokens</h4>
                        <ul>
                            <template for:each={tokenEntries} for:item="token">
                                <li key={token.key}><strong>{token.key}</strong>: {token.value}</li>
                            </template>
                        </ul>
                    </template>
                </section>
            </template>
        </div>
    </lightning-card>
</template>
